{"version":3,"sources":["components/Header/header.jsx","pages/Staff/Category/category.jsx"],"names":["header","props","className","title","children","getTypes","Staff","createList","deleteList","Category","handleCreate","val","index","state","isInput","message","listData","list","push","ref","input","size","type","onClick","handleRef","handleRefCancel","setState","pop","handleChange","e","target","checked","checkedData","value","filter","item","handleDelete","typeId","_id","data","i","valuePropName","onChange","length","style","position","right","handleComfirmDet","handleDetCancel","a","console","log","JSON","stringify","code","includes","this","handleGetTypes","map","extra","width","key","onDoubleClick","Component"],"mappings":"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","file":"static/js/20.04dd93b0.chunk.js","sourcesContent":["import React from \"react\";\r\nimport PropTypes from \"prop-types\";\r\nimport \"./header.scss\";\r\nfunction header(props) {\r\n  return (\r\n    <section className=\"staff-header\">\r\n      {props.title}\r\n\r\n      {props.children}\r\n    </section>\r\n  );\r\n}\r\n\r\nheader.propTypes = {\r\n  title: PropTypes.string.isRequired,\r\n};\r\n\r\nexport default header;\r\n","import React, { Component } from \"react\";\r\nimport \"./category.scss\";\r\nimport Header from \"../../../components/Header/header\";\r\nimport { Card, Space, Tooltip, Input, Button, Checkbox } from \"antd\";\r\nimport { DeleteOutlined, PlusOutlined } from \"@ant-design/icons\";\r\nimport message from \"../../../api/message\";\r\nimport { Staff } from \"../../../axios\";\r\nconst { getTypes, createList, deleteList } = Staff;\r\nexport default class Category extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      //列表数据\r\n      listData: [],\r\n      //未保存标识\r\n      isInput: false,\r\n    };\r\n    this.typeId = \"\";\r\n    //保存原始数据\r\n    this.data = [];\r\n    //保存选择的数据\r\n    this.checkedData = [];\r\n    //删除条目的下标\r\n    this.index = 0;\r\n  }\r\n  //添加子类\r\n  handleCreate = (val, index) => {\r\n    if (!this.state.isInput) {\r\n      const { listData } = this.state;\r\n      listData[index].list.push(\r\n        <Space>\r\n          <Input ref={(input) => (this.input = input)}></Input>{\" \"}\r\n          <Button\r\n            size=\"middle\"\r\n            type=\"primary\"\r\n            onClick={() => this.handleRef(val, index)}\r\n          >\r\n            保存\r\n          </Button>\r\n          <Button\r\n            size=\"middle\"\r\n            onClick={() => this.handleRefCancel(val, index)}\r\n          >\r\n            取消\r\n          </Button>\r\n        </Space>\r\n      );\r\n      this.setState({\r\n        listData,\r\n        isInput: true,\r\n      });\r\n    } else {\r\n      message(\"请先保存\");\r\n    }\r\n  };\r\n  //取消添加子类\r\n  handleRefCancel = (val, index) => {\r\n    const { listData } = this.state;\r\n    val.list.pop();\r\n    listData[index] = val;\r\n    this.setState({\r\n      listData,\r\n      isInput: false,\r\n    });\r\n  };\r\n  //选择子项事件\r\n  handleChange = (e, val, index) => {\r\n    this.index = index;\r\n    if (e.target.checked) {\r\n      this.checkedData.push(e.target.value);\r\n    } else {\r\n      this.checkedData = this.checkedData.filter(\r\n        (item) => item !== e.target.value\r\n      );\r\n    }\r\n  };\r\n  //删除子类\r\n  handleDelete = (val, index) => {\r\n    this.typeId = val._id;\r\n    if (!this.state.isInput) {\r\n      this.data = [...val.list];\r\n      const { listData } = this.state;\r\n      for (let i = 0; i < val.list.length; i++) {\r\n        val.list[i] = (\r\n          <Space>\r\n            <Checkbox\r\n              valuePropName=\"checked\"\r\n              value={val.list[i]}\r\n              onChange={(e) => this.handleChange(e, this.data[i], index)}\r\n            ></Checkbox>\r\n            {val.list[i]}\r\n          </Space>\r\n        );\r\n      }\r\n      val.list.push(\r\n        <section style={{ position: \"relative\" }}>\r\n          <Space style={{ position: \"absolute\", right: 0 }}>\r\n            <Button size=\"small\" type=\"danger\" onClick={this.handleComfirmDet}>\r\n              删除\r\n            </Button>\r\n            <Button size=\"small\" onClick={() => this.handleDetCancel(index)}>\r\n              取消\r\n            </Button>\r\n          </Space>\r\n        </section>\r\n      );\r\n      listData[index] = val;\r\n      this.setState({\r\n        listData,\r\n        isInput: true,\r\n      });\r\n    } else {\r\n      message(\"请先保存\");\r\n    }\r\n  };\r\n  //取消删除\r\n  handleDetCancel = (index) => {\r\n    const { listData } = this.state;\r\n    listData[index].list = this.data;\r\n    this.setState({\r\n      listData,\r\n      isInput: false,\r\n    });\r\n  };\r\n  //确认删除\r\n  handleComfirmDet = async () => {\r\n    const { listData } = this.state;\r\n    console.log(this.typeId);\r\n    if (this.checkedData.length) {\r\n      const { code } = await deleteList(\r\n        this.typeId,\r\n        JSON.stringify(this.checkedData)\r\n      );\r\n      if (code === \"200\") {\r\n        this.data = this.data.filter((item) => {\r\n          return !this.checkedData.includes(item);\r\n        });\r\n        listData[this.index].list = this.data;\r\n        this.setState({\r\n          listData,\r\n          isInput: false,\r\n        });\r\n        message(\"删除成功\", \"success\");\r\n      }\r\n    } else {\r\n      message(\"请选择删除的类别\");\r\n    }\r\n  };\r\n  //确定添加\r\n  handleRef = async (val, index) => {\r\n    if (this.input.state.value) {\r\n      const { listData } = this.state;\r\n      if (listData[index].list.includes(this.input.state.value)) {\r\n        message(\"该类别已存在\");\r\n        return;\r\n      }\r\n      const { code } = await createList(val._id, this.input.state.value);\r\n      if (code === \"200\") {\r\n        message(\"添加成功\", \"success\");\r\n        val.list.pop();\r\n        val.list.push(this.input.state.value);\r\n        listData[index] = val;\r\n        this.setState({\r\n          listData,\r\n          isInput: false,\r\n        });\r\n      }\r\n      return;\r\n    }\r\n    message(\"内容不能为空\");\r\n  };\r\n  //获取类别\r\n  async handleGetTypes() {\r\n    const { data, code } = await getTypes();\r\n    console.log(data);\r\n    if (code === \"200\") {\r\n      this.setState({\r\n        listData: data,\r\n      });\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    this.handleGetTypes();\r\n  }\r\n  render() {\r\n    return (\r\n      <>\r\n        {/* 管理类别 */}\r\n        <section className=\"staff-category\">\r\n          {/* 头部 */}\r\n          <Header title=\"管理类别\"></Header>\r\n          <section className=\"catrgory-main\">\r\n            {this.state.listData.map((val, index) => {\r\n              return (\r\n                <Card\r\n                  className=\"main-card\"\r\n                  title={val.type}\r\n                  key={val._id}\r\n                  extra={\r\n                    <Space>\r\n                      <Tooltip title=\"添加子类\">\r\n                        <PlusOutlined\r\n                          onClick={() => this.handleCreate(val, index)}\r\n                        />\r\n                      </Tooltip>\r\n                      <Tooltip title=\"删除子类\">\r\n                        <DeleteOutlined\r\n                          onClick={() => this.handleDelete(val, index)}\r\n                        />\r\n                      </Tooltip>\r\n                    </Space>\r\n                  }\r\n                  style={{ width: 300 }}\r\n                >\r\n                  {val.list.map((item, key) => {\r\n                    return (\r\n                      <section\r\n                        onDoubleClick={() => this.handleDelete(val, key)}\r\n                        className=\"card-item\"\r\n                        key={key}\r\n                      >\r\n                        {item}\r\n                      </section>\r\n                    );\r\n                  })}\r\n                </Card>\r\n              );\r\n            })}\r\n          </section>\r\n        </section>\r\n      </>\r\n    );\r\n  }\r\n}\r\n"],"sourceRoot":""}